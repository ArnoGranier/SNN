# SNN
[TER-MIASHS][Python 3.6-Tensorflow] Spiking Neural Network Lib
Dans une idee de rapprochement entre la modelisation du systeme nerveux et l'intelligence artificielle

### PARTIE I

**CODE -** *A peu pres fini*
1. Rentrer le modele facilement 02/02 -> ok 
2. simuler le modele 03/02 -> ok
3. phase plan and dynamics -> 05/02 -> ok
4. interactive plot phase plan with click, eventually 3d -> 07/02 -> 2/3 ok manque 3d

**WRITTING -** *En cours*
1. Intro -> OK (putain enfin, si je puis me permettre -_-)
	
	(nldr : dans ce travail on va souvent assimiler, par facilite de redaction, l'homme a son systeme nerveux, ou a son systeme cognitif. On essaiera d'employer le terme "systeme nerveux" plutot que "cerveau" ou "encephale", pour rester general et conserver l'importance du systeme nerveux peripherique.).
	Les sciences peuvent etre definies comme un moyen pour les hommes de produire ou d'utiliser de la connaissance a l'aide de moyens consideres comme rationnels, methodiques et objectifs. Au sein des sciences, on troue notamment les sciences formelles, dont l'objet est l'etude et la manipulation de systemes formels, c'est-a-dire un systeme bien defini et autonome base sur une axiomatique admise et a partir duquel on produit de la connaissance a l'interieur du systeme en se servant de regles de deduction bien definies. On trouve egalement, parmis les sciences, les sciences dites "de l'Homme" ou encore "de l'esprit", "de la Culture". Cette formulation montre un interet des sciences dans l'application d'un modele et d'une methodologie scientifiques a un objet bien particulier : l'humain. On va parler ici de science de l'homme "au singulier", c'est-a-dire qu'on parle des sciences qui s'interessent a l'humain a l'echelle de l'individu, des sciences s'interessant a l'esprit humain. L'humain est un objet particulier dans le sens ou son etude parait de premier abord contredire un des criteres de scientificite principal qui est celui de l'objectivite, c'est-a-dire la non-influence de l'observateur sur l'objet, en effet : dans l'etude de l'Homme l'observateur et l'objet sont de la meme nature. Mais aussi et surtout, nos etats interieurs (etats mentaux) nous sont propre et sont non-observable directement chez autrui, ce qui rend toute science impliquant ces etats mentaux difficile.
	
	Cependant, le developpement de discipline comme la psychophysiologie ou plus generalement les neurosciences nous permet d'envisager une naturalisation de la cognition humaine (ou du moins d'une partie de la cognition humaine). C'est-a-dire que la cognition humaine serait explicable en des termes des sciences naturelles, notamment a travers la biologie et la physique du systeme nerveux humain. On s'inscrit alors dans un courant naturaliste, voire physicaliste. C'est une facon de minimiser les problemes evoques precedemment, puisqu'une naturalisation (ou une physicalisation) de l'esprit humain permettrait alors de l'etudier de la meme maniere que n'importe quel autre objet des sciences naturelles (ou physiques), et on aurait de plus une explication possible des etats mentaux humains par certaines proprietes de la matiere. De plus, et en accord avec une theorie fonctionnaliste, on va plutot definir les etats mentaux par leur fonction, au sein du mental ou au sein de l'organisme, plutot que par leur substrat physique, la matiere n'etant que la base permettant la realisation de cette fonction. Avec cette approche physicaliste-fonctionnaliste, __il est donc theoriquement envisageable de reproduire l'esprit humain dans une machine, pourvu que l'on reproduise toute les proprietes physiques du systeme nerveux humain.__ Le physicalisme nous permettant d'attribuer entierement l'esprit humain aux proprietes physiques du systeme nerveux humain, et le fonctionalisme nous permettant de nous affranchir d'une incarnation forcement dans le systeme nerveux pour nous etendre a une incarnation possible dans tout systeme _fonctionnant comme_ le systeme nerveux. 
	
	Mais qu'est-ce que ca veut dire _fonctionner comme_ le systeme nerveux ? Pour repondre a cete question, il nous faut nous tourner vers les sciences naturelles : neurosciences, biologie, physique, etc ... qui etudient les proprietes biologiques, chimiques et physiques du cerveau. Ces sciences nous apprennent que le systeme nerveux humain est un systeme extremement complexe, et nos connaissances sur les proprietes biologiques, chimiques et physiques de ce systeme sont loins d'etre completes. Si l'on veut tenter de resumer le fonctionnement du systeme nerveux en quelques mots, on aurait tendance a dire qu'il s'agit d'un reseaux organise et adaptatif d'unites de base connectees entre elles, dont le but et de recevoir, analyser et transmettre de l'information. Cette reduction est tres schematique mais semble pourtant contenir l'essence du fonctionnement du systeme nerveux humain. L'unite de base de ce systeme est le neurone, qui est une cellule capable de recevoir et de propager de l'information sous forme electro-chimique (l'influx nerveux). Les connexions entre les neurones sont appelles synapses, ce sont des zones ou l'information est transmises d'un neurone a l'autre de maniere chimique, et il est egalement globalement admit que c'est au sein des synapses que prennent place les proprietes d'adaptation du reseau.
	
	Si l'on reste dans l'approche physicaliste-fonctionnaliste, il semble donc naturel de vouloir tente de "reproduire" le fonctionnement du systeme nerveux humain dans _autre chose que l'humain_, et le meilleur candidat pour cet _autre chose_ semble etre l'ordinateur. Cependant, il est ici important d'etre lucide sur le sens du mot "reproduire" dans cette phrase : d'une part, comme nous l'avons dit, nous sommes loin d'avoir une connaissance exhaustive des proprietes des neurones et des synapses, et de plus le systeme nerveux ne se resume pas en realite qu'aux neurones et synapses (il faudrait prendre en compte les cellules gliales, l'impact des hormones, reproduire le fonctionnement de toutes les afferences aux systemes nerveux, comme les recepteurs cutanes, etc ..) ; et d'autre part, en supposant une connaissance exhaustive du systeme nerveux, la reproduction exacte de son fonctionnement _in silico_ ne serait peut-etre pas si aisee, notamment car le substrat biologique permet peut-etre des fonctions difficilement reproductible dans un substrat electronique. C'est pour cela que plutot que de parler de "reproductione du fonctionnement du systeme nerveux, on parlera plutot de modelisation du systeme nerveux, de modelisation de neurones et de synapses, dans le sens ou on selectionne les proprietes du systeme nerveux qui nous semblent les plus importantes dans son fonctionnement et ou on essaye de les rendre intelligiebles, pour la machine grace a une formalisation mathematique et a des programmes permettant de simuler le comportement des modeles de neurone et de reseaux de neurones, et pour l'homme a l'aide de graphiques, de donnees bien choisies et d'analyse mathematique des modeles (lorsque cela est possible).
	
	J'aimerai degager deux grands axes dans l'activite de la modelisation mathematique et informatique du systeme nerveux :
	1. Reproduire les proprietes physique et biologiques du systeme nerveux (ie ici des neurones et reseaux de neurones) 
	2. Faire emerger des proprietes cognitives a partir de modeles du systeme nerveux et observer, analyser et comprendre cette emergence.

	Un certain avancement dans le premier axe etant bien evidemment necessaire a l'accomplissement du second.

	De la premiere proposition (1.) on peut degager deux approches :  
		a. __Reproduire le plus fidelement possible un neurone ou un reseau de neurone sans se soucier de la complexite du modele__, ce qui donne un modele plus precis, plus proche de la realite, mais difficilement manipulable et comprehensible, et dont la simulation est couteuse (en temps). On retrouve dans cette categorie la plupart des modeles dit "physiologiques", c'est-a-dire les modeles qui s'inspirent du fonctionnement biologique du systeme nerveux et tentent de le formaliser.  
		b. __Faire un compromis entre le realisme du modele et sa complexite__, ce qui donne des modeles moins precis et moins proche de la realite, mais plus facilement manipulable, comprehensible et dont la simulation est rapide. On retrouve dans cette categorie la plupart des modeles dit "phenomenologiques", c'est-a-dire les modeles qui, sans la contrainte de s'inspirer du biologique, tentent de reproduire le fonctionnement du systeme nerveux en terme de donnees quantitatives "de plus haut niveau", comme par exemple le potentiel de membrane d'un neurone. 
	
	Et de la deuxieme proposition (2.) on peut degager deux buts :  
		c. __Creer des machines douees de proprietes cognitives__ : On a donc ici une intentionalite qui appartent au domaine de l'intelligence artificielle ou de la cognition artificielle et une methodologie de realisation qui appartient au domaine de la modelisation du systeme nerveux. Il est logique de se rapprocher voire de se confondre avec ces champs recherche des lors ou notre intention, dans notre tache de modelisation, est celle de tenter de faire emerger des proprietes cognitives d'une machine. On peut ici preciser l'approche de l'IA-modele-du-cerveau en la comparant a une approche plus classique en intelligence artificelle : celle des reseaux de neurones formels.  Le neurone : Modele de neurone biologique / neurone formel  La connexion entre les neurones : modele de synapses biologiques / connexions simple avec poids  La methode d'apprentissage : Methode d'apprentissage s'inspirant de ce qu'on sait de l'apprentissage dans le systeme nerveux / surtout apprentissage supervise,   Architecture : Inspiree de celle du cerveau / cherchant a maximiser l'efficacite du systeme, generalement choisie par un humain.  Il aurait ete tres interessant de debattre sur les questions : Est-ce que reproduire le fonctionnement du systeme nerveux humain est la voie la seule voie pour atteindre une machine avec une intelligence proche de l'humain (et sur quelle critere jugee de la reussite d'une telle entreprise ?) ? Est-ce la plus simple ? 
		d. __Mieux comprendre le fonctionnement du systeme nerveux__ : en effet posseder un modele simule par ordinateur du systeme nerveux ou d'une partie du systeme nerveux permettrait d'etudier l'impact de lesions dans un emplacement parfaitement controlees, d'avoir des donnees parfaitement "propres" et precises sur lesquelles travailler, de mettre en place beaucoup plus facilement des procedures d'analyse en se servant des outils mathematiques et informatiques, etc ...
Par exemple, supposons que l'on dispose d'un modele du systeme nerveux, que l'on subdivise ce modele en plusieurs sous-parties, et que l'on souhaite savoir quel est l'ensemble minimal de sous-parties du modele necessaire pour que le modele possede une certaine capacite C. Supposons de plus (et c'est une supposition assez lourde) que l'on possede une mesure M capable de determiner si un systeme possede la capacite C (M(C) vrai si le systeme possede C, faux sinon). Alos on peut envisager de mettre en place un algorithme du type :  
		```
		Pour toutes les sous-parties du systeme  
	Tenter d'enlever la sous-partie courante:  
	Si M(C) est vrai:  
		On enleve definitivement la sous-partie  
	sinon:  
		On reintegre la sous-partie dans le systeme
		```  
		Si les sous-parties en lesquelles on a subdivise le systeme sont des zones spatiales, c'est-a-dire des ensembles de neurones (voire un neurone), alors cette algorithme revient, dans une approche plus classique, a faire des lesions successives de zones du cerveau. Si les sous-parties sont des proprietes des neurones ou des synapses, cela revient dans une approche classique, a bloquer successivement, a l'aide de composantes chimiques par exemple, certaines proprietes des neurones ou des synapses.  
Un modele informatique du systeme nerveux permettrait de repondre a ce genre de question de maniere certaine (a l'interieur du modele) et rapide. Il est egalement important d'insister sur la facilite d'acquistion de donnees aussi precises que l'on veut (dans la limite de la precision de l'ordinateur). 

	Maintenant, tout en gardant en tete toutes ces idees, il est temps pour moi de definir plus precisement l'objet de ce travail. Dans une premiere partie, je m'interesserai aux differents modeles de neurones existants et je creerai mon propre outil de definition et de simulation de ces modeles en Python 3+. Dans une deuxieme partie, je me tournerai vers les modeles de synapses et je m'interesserai aux manieres de creer et simuler des reseaux de neurones _in silico_, tout en creant mon propre outil de definition et de simulation de reseaux de spiking neurons en Python3+/Tensorflow. Dans une troisieme partie, et a l'aide de l'outil creer dans la deuxieme partie, je tenterai de reproduire les resultats de Herice et all 2016, c'est-a-dire construire un modele des ganglions de la base sous forme de reseaux de spiking neurons, capable de prendre des decisions.
		
	(Apparte : Motivation personnelles) C'est donc avec ces idees (celles enoncees dans l'introduction pour ceux qui lisent dans le desordre) que j'aborde ce Travail Encadre de Recherche dans le cadre de ma troiseme annee de licence de Mathematiques et Informatique appliques aux sciences humaines et sociales - Parcours Sciences Cognitive a l'universite de Bordeaux. Ce TER a, je dois bien l'avouer, surtout une portee d'apprentissage pour moi, puisque j'espere qu'il me permettra d'acquerir les connaissances necessaire sur la modelisation du systeme nerveux pour ensuite poursuivre les buts enonces dans l'introduction dans la suite de mes etudes, puis en recherche. Pour justifier la creation de mes propres outils de definition et de simulation des modeles, je dirais que cela me permettra une comprehension profonde de la maniere dont fonctionnent ces outils, notamment des methodes de simulation numerique. De plus, il y a un manque d'outil de creation de reseaux de spiking neurons en Python, et je pense que l'utilisation de tensorflow (bibliotheque de computation parallele et optimisee) se revelera pertinente, et j'espere ainsi, au cours de se travail et apres, creer une bibliotheque de creation de modeles de reseaux de neurones biologiques facile d'utilisation et optimisee en terme de computation, du moins autant que cela est possible. Enfin l'etude et la reproduction des travaux de Herice et all 2016 permettront, en plus de m'apporter de la connaissance et de la pratique sur la base d'une partie de la litterature recente sur le sujet, d'apporter une justification de l'utilite de mon outil de simulation de reseaux de neurones.
	

	(Apparte : les paradigmes d'etude psychologique de la cognition humaine) Parmis les grands paradigmes qui ont ete explores dans l'etude de l'esprit humain, on peut citer (maniere non exhaustive) le behaviorisme, le cognitivisme et le connexionnisme. Le behaviorisme a tente d'etudier l'humain en le reduisant a son comportement observable, c'est-a-dire ses interactions observables avec l'environnement. Cette approche est aujourd'hui consideree comme desuette, aussi, on ne s'attardera pas dessus. Le cognitivisme, paradigme fondateur des sciences cognitives, considere que le systeme nerveux humain peut (et doit) etre etudie comme un systeme de traitement de l'information creant et manipulant des representations symboliques et semantiques du monde, ces representations possedant des proprietes syntaxiques. Dans ce systeme cognitiviste, la pensee est comparee a une serie d'application de regles (ou dit plus simplement, un calcul) sur les representations. Le connexionnisme modelise les phenomenes mentaux comme des processus emergents de reseaux d'unites simples interconnectees. On oppose souvent cognitivisme et connexionnisme (ou pour etre plus precis, computationnalisme et connexionnisme), en pensant que ce sont deux modes de pensees completements opposes. Pourtant, les deux formulent la pensee comme un calcul sur des symboles. Les differences entre ces deux paradigmes se situent au niveau de la localisation des proprietes syntaxiques et semantiques et dans la forme des regles de manipulation. Dans le cognitivisme, les proprietes syntaxiques et semantiques sont attribuees aux representations et les regles de manipulation sont algorithmiques et lineaires. Dans le paradigme connexioniste, les proprietes syntaxiques et les regles de calculs sont representees par un reseau d'unites de bases interconnectees et dependent entieremment du fonctionnement de ces unites et de l'architecture du reseaux, et les regles de calculs peuvent etre massivement paralleles ; tandis que les proprietes semantiques sont attribuees au reseau en lui-meme (en entier). On peut situer notre approche comme etant partie du courant connexionniste, meme si dans le cas de ce travail, ce n'est pas vraiment important.
	


1. Quelques rappels de neurobiologie
	Cette partie sera concise et aura pour but de rappeller quelques notions de neurobiologie necessaire a la comprehension de la suite, sans en faire trop. On suppose que le lecteur est deja familie avec les notions fondamentales de la neurobiologie, si ce n'est pas le cas, on renvoie a Principles of Neural Science de Eric Kandel.  
Le neurone est une cellule capable de recevoir et transmettre de l'information sous forme electro-chimique. On peut decomposer schematiquement les differentes etapes de la reception et transmition de l'information in vivo dans un neurone par :
	1. Reception de neurotransmetteurs et ouverture des canaux chimio-dependants
	2. Excitation electrique locale du neurone du a l'ouverture des canaux chimio-depedants
	3. Lorsque l'excitation locale depasse un certain seuil, creation d'un potentiel d'action
	4. Transmition du potentiel d'action a travers l'axone
	5. Liberation de neurotransmetteur dans la fente synaptique du a l'arrivee du potentiel d'action dans le bouton synaptique 
	6. Repeter 1. pour le neurone post-synaptique

	Lorsqu'on souhaite etudier les proprietes d'excitation d'un neurone en laboratoire, on va generalement provoquer l'excitation du neurone en injectant directement un courant electrique dans le neurone, et on va s'interesser a la production de potentiels d'action en fonction des proprietes du courant injecte, notamment de son intensite (technique de patch-clamp). 

	Dans cette idee d'etude de la production de potentiel d'action en fonction des proprietes d'un courant injecte directement dans le neurone, on ne decrira pas ici les mecanismes a l'oeuvre dans la synapse.

	Le concept fondamental de neurobiologie en lien avec cette partie est celui de la creation du potentiel d'action. On rappellera ici succintement les mecanismes neurobiologiques a l'oeuvre. On peut decomposer la generation d'un potentiel d'action en 5 phases :
	1. Depolarisation faible : ouverture de certain canaux sodiques, entree des ions Na2+ dans le milieu intracellulaire ;
	2. Depolarisation forte suite au depassement de seuil : Lorsqu'un certain seuil de potentiel electrique est atteint (le potentiel de seuil), la membrane va subir une depolarisation forte, allant jusqu'a un inversement de polarite ou le potentiel de la membrane est d'environ 40 mV. Cette depolarisation est due a l'ouverture massive de canaux sodiques. Une fois le changement de polarite effectue, l'inversion du gradient electrochimique va ralentir l'entree des ions Na2+ dans la cellule ;
	3. Repolarisation : L'ouverture des canaux potassiques et l'inactivation des canaux sodiques entraine la sortie massive d'ions K+ et un arret de l'entree des ions Na2+;
	4. Hyperpolarisation : En continuite de la repolarisation, on observe que le potentiel membranaire ne revient pas directement au potentiel de repos, mais passe sous le potentiel de repos pendant un certain temps que l'on appelle la periode refractaire. Cela est du au fait que les canaux potassiques restent ouverts plus longtemps que les canaux sodiques, on a donc une sortie d'ions K+ plus importante que necessaire pour revenir au potentiel de repos;
	5. Retour au potentiel de repos : Le retour au potentiel de repos est assure par la pompe Na2+/K+ ATPase.
	
	![alt Text](https://user-images.githubusercontent.com/27825602/36450932-b77c1b44-168f-11e8-975d-c6203f21f177.jpg)  
	FIG1 - Potentiel de la membrane en fonction du temps lors de la production d'un potentiel d'action

1. Modele de Hodgkin Huxley 14/02
	L'approche de Hodgkin et Huxley sur la question de la modelisation de neurones est une approche qui possede une grande "clarte physiologique", dans le sens ou chaque composante du modele represente une realite biologique ou electrique descriptible dans les termes de la neurobiologie. On peut ainsi attribuer au modele de Hodgkin-Huxley une certaine coherence et validite par rapport aux sciences naturelles (notamment neurobiologie encore une fois). Mais voyons ca plus en details ..
	1. Les equations des canaux ioniques
	on suppose que y'en a que deux, 4 compartiment, des formules
	2. L'equation du potentiel membrane
	Representation par circuit RC, Interpretation et appliquation de la loi de Kirchhoff pour trouver l'equation
	3. Simulation avec SNN.single et explication des dynamiques a partir de m,n,h (voir Wash)
	

1. Interets de reduire Hodgkin-Huxley (Quand faut-il privilegier la rapidite d'execution au realisme biologique ?), reduction aux modeles de Fitzugh-Nagumo, modele de Izhiekievich 17/02
	Expliquer le compromis entre realisme biologique et rapidite d'execution, modele pheno et modele physio. Le but principal de ce TER est d'etudier et de produire un outil poural simulation de RESEAUX de neurones de grande taille, ainsi dans cette partie qui porte sur la modelisation d'un seul neurone, on a tout interet a se concentrer sur les modeles qui sont des simplifications de HH.
Explication de la reduction au modeles de FHN, simulations avec SNN.single, puis explications de FHN -> Izhi, encore une fois simulation.


1. Modele leaky-integrate and fire 19/02
	Encore plus simple : le modele leaky-integrate and fire, presentation du modele, explications, simulations.


1. Quelques mots sur les modeles compartimentaux et augmentation de Hodkin-Huxley 20/02
	Principe (approximation des differentes composantes par des cylindres) et equation du cable. Interets ( biologiquement + realiste). Techniques de reduction du nombre de compartiments avec same beahvior. 



Commencer le site -> 1/03
Si fini avant 1/03, s'interesser a d'autres methodes de simulations numeriques (r4k done)

**Pitit exemple** :
```
from brnn.single import *

v = Variable(name='v', ddt='0.04*v**2+5*v+140-u+I', init_value=-65, 
			 reset_value='c', unit='mV')
u = Variable(name='u', ddt='a*(b*v-u)', init_value=-15, reset_value='u+d')
izhi_model = Model(v, u, spike_when='v>=30', max_spike_value=30, 
        a=0.02, b=0.2, c=-65, d=8, I=lambda t : 0 if t<200 or t>800 else 5)
fig1 = izhi_model.plot(1000, 1, keep=['I', 'u', 'v'])
fig2 = izhi_model.plot(1000, 1, keep=['I', 'u', 'v'], subplotform='22')
fig3 = izhi_model.plan_phase(('v', -80, -30, 5), ('u', -30, 20, 5),
                       rescale=True)
fig4 = izhi_model.plan_phase(('v', -80, -30, 5), ('u', -30, 20, 5),
                       interactive=True, no_dynamics=True)
plt.show()
```

![alt Text](https://user-images.githubusercontent.com/27825602/36076476-e6d45882-0f5c-11e8-95d9-1e9a16462bbc.JPG)
![alt Text](https://user-images.githubusercontent.com/27825602/36076477-e7ec5936-0f5c-11e8-9830-e70f3b350b75.JPG)
![alt Text](https://user-images.githubusercontent.com/27825602/36076478-e993eede-0f5c-11e8-99e9-2dd3d4f44b07.JPG)
![alt Text](https://user-images.githubusercontent.com/27825602/36076474-e60e1bcc-0f5c-11e8-9dba-75ee33e47904.gif)


